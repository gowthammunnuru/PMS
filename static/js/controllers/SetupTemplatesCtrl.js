// Generated by CoffeeScript 1.8.0
angular.module("perform").controller("SetupTemplatesCtrl", [
  "$scope", "$state", "$stateParams", "WS", "Utils", "$location", "allUsers", "allTemplates", "allReviews", function($scope, $state, $stateParams, WS, Utils, $location, allUsers, allTemplates, allReviews) {
    $scope.review_year = $stateParams.review_year;
    $scope.review_name = $stateParams.review_name;
    $scope.allTemplates = allTemplates;
    $scope.setupAndPreview = function(template) {
      'This method is copy/paste to js/controllers/9BoxCtrl.coffee';
      if (template['weights-performance'].error || template['weights-potential'].error) {
        return WS.setTemplateWeights(template.id, $scope.review_year, $scope.review_name).then((function(_this) {
          return function(response) {
            return $state.go('admin.templates.preview_template.render', {
              review_year: $scope.review_year,
              review_name: $scope.review_name,
              template_id: template.template_id
            });
          };
        })(this));
      } else {
        return $state.go('admin.templates.preview_template.render', {
          review_year: $scope.review_year,
          review_name: $scope.review_name,
          template_id: template.template_id
        });
      }
    };
  }
]);
